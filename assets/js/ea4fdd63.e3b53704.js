"use strict";(self.webpackChunkscience_island_docs=self.webpackChunkscience_island_docs||[]).push([[9198],{2269:(e,o,i)=>{i.r(o),i.d(o,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"tools-and-technologies/docker/multiple-docker-files","title":"Dockerfile vs local.Dockerfile","description":"Using different Docker files for local vs production builds.","source":"@site/docs/02-tools-and-technologies/03-docker/06-multiple-docker-files.md","sourceDirName":"02-tools-and-technologies/03-docker","slug":"/tools-and-technologies/docker/multiple-docker-files","permalink":"/si-docs/tools-and-technologies/docker/multiple-docker-files","draft":false,"unlisted":false,"editUrl":"https://github.com/EducationNetworkGroup/si-docs/tree/main/docs/02-tools-and-technologies/03-docker/06-multiple-docker-files.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"description":"Using different Docker files for local vs production builds."},"sidebar":"tutorialSidebar","previous":{"title":"View Database within a Docker Container","permalink":"/si-docs/tools-and-technologies/docker/view-db-within-docker-container"},"next":{"title":"Docker Compose","permalink":"/si-docs/category/docker-compose"}}');var r=i(4848),t=i(8453);const c={sidebar_position:6,description:"Using different Docker files for local vs production builds."},s="Dockerfile vs local.Dockerfile",l={},d=[{value:"How the different Dockerfiles are used",id:"how-the-different-dockerfiles-are-used",level:2},{value:"Local",id:"local",level:3},{value:"Production",id:"production",level:3}];function a(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.header,{children:(0,r.jsx)(o.h1,{id:"dockerfile-vs-localdockerfile",children:"Dockerfile vs local.Dockerfile"})}),"\n",(0,r.jsxs)(o.p,{children:["Throughout the project, you will see places where multiple Dockerfiles are defined. For instance, within ",(0,r.jsx)(o.a,{href:"https://github.com/EducationNetworkGroup/Mapping-System-2022S2/tree/main/src/frontend",children:"Mapping-System-2022S2/src/frontend/"})," there is a ",(0,r.jsx)(o.a,{href:"https://github.com/EducationNetworkGroup/Mapping-System-2022S2/blob/main/src/frontend/Dockerfile",children:(0,r.jsx)(o.code,{children:"Dockerfile"})})," and a ",(0,r.jsx)(o.a,{href:"https://github.com/EducationNetworkGroup/Mapping-System-2022S2/blob/main/src/frontend/local.Dockerfile",children:(0,r.jsx)(o.code,{children:"local.Dockerfile"})}),"."]}),"\n",(0,r.jsxs)(o.p,{children:["As you might imagine, the ",(0,r.jsx)(o.code,{children:"Dockerfile"})," builds a production-ready image of this React frontend, while the ",(0,r.jsx)(o.code,{children:"local.Dockerfile"})," builds a development image of that same project. They each read in different ",(0,r.jsx)(o.code,{children:".env"})," files and set things up slightly differently."]}),"\n",(0,r.jsxs)(o.p,{children:["The ",(0,r.jsx)(o.code,{children:"local."})," prefix is the convention used within the project for development images, but you can change this to anything and have as many different Dockerfiles as you like."]}),"\n",(0,r.jsx)(o.h2,{id:"how-the-different-dockerfiles-are-used",children:"How the different Dockerfiles are used"}),"\n",(0,r.jsx)(o.h3,{id:"local",children:"Local"}),"\n",(0,r.jsxs)(o.p,{children:["Generally, where there are multiple Dockerfiles, the local version will be used by the ",(0,r.jsx)(o.code,{children:"docker-compose.yaml"})," file with code similar to this:"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-yaml",children:'mapper-frontend:\n    platform: "linux/amd64"\n    container_name: mapper-frontend\n    build:\n        context: ./src/frontend\n        dockerfile: local.Dockerfile\n'})}),"\n",(0,r.jsx)(o.h3,{id:"production",children:"Production"}),"\n",(0,r.jsxs)(o.p,{children:["The production build will then generally be created by the ",(0,r.jsx)(o.code,{children:"Publish.yaml"})," GitHub Actions Workflow, and pushed to the Github Container Registry, similar to this:"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-yaml",children:"- name: Build & Publish Image\n    run: |\n    TAG=$(echo $GITHUB_REF_NAME | sed 's|/|-|g')\n    docker build ./src/frontend --tag ghcr.io/educationnetworkgroup/si-curriculum-mapper-frontend:${TAG}\n    docker push ghcr.io/educationnetworkgroup/si-curriculum-mapper-frontend:${TAG}\n"})}),"\n",(0,r.jsxs)(o.p,{children:["Here, the basic ",(0,r.jsx)(o.code,{children:"Dockerfile"})," is implied, so it doesn't need to be explicitly stated in the ",(0,r.jsx)(o.code,{children:"docker build"})," command."]}),"\n",(0,r.jsxs)(o.p,{children:["This is the image that you can find in the ",(0,r.jsx)(o.a,{href:"https://github.com/orgs/EducationNetworkGroup/packages",children:(0,r.jsx)(o.code,{children:"Packages"})})," tab within EducationNetworkGroup."]})]})}function h(e={}){const{wrapper:o}={...(0,t.R)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,o,i)=>{i.d(o,{R:()=>c,x:()=>s});var n=i(6540);const r={},t=n.createContext(r);function c(e){const o=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),n.createElement(t.Provider,{value:o},e.children)}}}]);